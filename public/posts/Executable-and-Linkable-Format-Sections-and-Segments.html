<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Executable and Linkable Format - Sections and Segments | Security Research Blog</title>
    <meta name="description" content="So the ELF or Excecutable and Linkable format are programs or binaries that are used in linux systems. ELFs contain 3 components namely: * ELF Headers * ELF Seg...">
    <link href="/src/index.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <style>
        body { 
            background: linear-gradient(135deg, #0c0c0c 0%, #1a1a1a 100%);
            color: #e0e0e0;
        }
        .code-block {
            background: #1e1e1e;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 1rem;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
        }
        .gradient-text {
            background: linear-gradient(135deg, #f97316, #f59e0b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .video-embed { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; border-radius: 8px; border: 1px solid #374151; background: #0f0f0f; margin: 1.5rem 0; }
        .video-embed iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
        .prose h1 {
            background: linear-gradient(135deg, #f97316, #f59e0b); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
            font-size: 2.5rem;
            font-weight: 800;
            margin-top: 3rem;
            margin-bottom: 1.5rem;
        }
        .prose h2 {
            background: linear-gradient(135deg, #f97316, #f59e0b); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
            font-size: 2rem;
            font-weight: 700;
            margin-top: 3rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #374151;
            padding-bottom: 0.5rem;
        }
        .prose h3 {
            background: linear-gradient(135deg, #f97316, #f59e0b); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
            font-size: 1.5rem;
            font-weight: 600;
            margin-top: 2rem;
            margin-bottom: 0.75rem;
        }
        .prose h4 {
            background: linear-gradient(135deg, #f97316, #f59e0b); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
            font-size: 1.25rem;
            font-weight: 600;
            margin-top: 1.5rem;
            margin-bottom: 0.5rem;
        }
        .prose p {
            margin-bottom: 1.5rem;
            line-height: 1.7;
            color: #d1d5db;
        }
        .prose strong {
            color: #f3f4f6;
            font-weight: 600;
        }
        .prose code {
            background: #1e1e1e;
            color: #fbbf24;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        .prose pre {
            background: #1e1e1e;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 1.5rem;
            overflow-x: auto;
            margin: 2rem 0;
        }
        .prose pre code {
            background: transparent;
            color: #e5e7eb;
            padding: 0;
            border-radius: 0;
        }
        .prose blockquote {
          background:rgb(93, 45, 26);
          color:rgb(255, 255, 255);
          border-left: 4px solid #ff8c00;
          padding: 1rem 1.25rem;
          margin: 1.25rem 0;
          border-radius: calc(var(--radius) - 2px);
        }
        .prose ul, .prose ol {
            list-style-color: #ff8c00;
            list-style-type: disc;
            list-style-position: outside;
            margin: 1.5rem 0;
            padding-left: 2rem;
        }
        .prose li {
            margin: 0.5rem 0;
            color: #d1d5db;
        }
        .prose li::marker {
            color: #ff8c00 !important;
        }
        .prose ol li {
            list-style-type: decimal;
        }
        .prose table {
            margin: 2rem 0;
            background: #1e1e1e;
            border-radius: 8px;
            overflow: hidden;
        }
        .prose th, .prose td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #333;
        }
        .prose th {
            background: #2d2d2d;
            color: #f3f4f6;
            font-weight: 600;
        }
        .prose img {
            border-radius: 8px;
            margin: 2rem 0;
            max-width: 100%;
        }
        .prose hr {
            border: none;
            height: 2px;
            background: linear-gradient(90deg, transparent, #374151, transparent);
            margin: 3rem 0;
        }
        .prose a { color: rgb(3, 203, 146); text-decoration: underline; }
    </style>
</head>
<body class="min-h-screen">
    <div class="container mx-auto max-w-7xl px-4 sm:px-6 lg:px-4 py-8 relative">
        <header class="mb-12">
            <a href="/blogs" class="text-emerald-400 hover:text-emerald-300 mb-4 inline-block">← Back</a>
            <h1 class="text-4xl md:text-5xl font-bold mb-4">
                <span class="gradient-text">Executable and Linkable Format - Sections and Segments</span>
            </h1>
            <div class="mb-8"><img src="/posts/Executable-and-Linkable-Format-Sections-and-Segments/featured.png" alt="Executable and Linkable Format - Sections and Segments cover image" class="w-full h-64 md:h-80 object-cover rounded-lg shadow" loading="eager"></div>
            <div class="flex items-center gap-4 text-sm text-gray-400 mb-6">
                <span>September 10, 2020</span>
                <span>•</span>
                <span>4 min read</span>
                <span>•</span>
                <div class="flex gap-2"><span class="bg-blue-500/20 text-blue-300 px-2 py-1 rounded text-xs">sections</span> <span class="bg-blue-500/20 text-blue-300 px-2 py-1 rounded text-xs">segments</span> <span class="bg-blue-500/20 text-blue-300 px-2 py-1 rounded text-xs">ELF</span></div>
            </div>
        </header>

        <article class="prose prose-invert max-w-none">
<p>So the ELF or Excecutable and Linkable format are programs or binaries that are used in linux systems. ELFs contain 3 components namely:</p>
<!--more-->
<ul>
<li>ELF Headers</li>
<li>ELF Segments</li>
<li>ELF Sections</li>
</ul>
<h2 id="need">Need:</h2>
<p>A good reason to learn ELF format is it helps you to understand things easily when you do binary analysis or when you are curious to know how the Operating System works. There are several reasons why you need to know them …</p>
<h1 id="elf-headers">ELF Headers</h1>
<p>Firstly we will be looking at ELF which are 64 bits, dynamically linked, not stripped.<br />
<img src="/images/ELF_segments_sections_short_blog/2.png" alt="" /></p>
<p>Lets look at the ELF header with readelf. </p>
<pre><code>readelf -h binary
</code></pre>
<p><br />
<img src="/images/ELF_segments_sections_short_blog/1.png" alt="" /></p>
<h2 id="magic">magic</h2>
<p>We can see from the image that our header / binary starts with the magic bytes Magic: 45 4c 46 which corresponds to ELF in ascii. This magic bytes tell the file command that this is an Excecutable and Linkable Format. </p>
<h2 id="class">Class</h2>
<p>This binary has a class of 64 bits because when I compiled, it was in a 64 bit machine so by default it will be 64 bits. Inorder to compile a 32 bit binary we need to give the -m32 flag to gcc.</p>
<h2 id="data">Data</h2>
<table>
<thead>
<tr>
<th style="text-align:center;">Little Endian</th>
<th style="text-align:center;">Big Endian</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">The bytes of a word are arranged from right to left</td>
<td style="text-align:center;">The bytes of a word are arranged from left to right</td>
</tr>
<tr>
<td style="text-align:center;">The address of the word (assume 4 bytes) will point to 4 th bytes</td>
<td style="text-align:center;">The address of that word (assume 4 bytes) will point to the 1st bytes</td>
</tr>
</tbody>
</table>
<p>So in our case its little endian and most 64 bit amd processors compile it in little Endian.</p>
<h2 id="osabi">OS/ABI</h2>
<p>Nothing to tell about OS (Operating System). I compiled this is my laptop which is Linux hence Unix.</p>
<h2 id="machine">Machine</h2>
<p>Tells us we have x86 architecture with 64 bits.</p>
<h2 id="type">type</h2>
<p>Not sure why its DYN(Shared Object). It should have been EXEC (Executable file).[will update soon].</p>
<h2 id="rest">Rest</h2>
<p>Rest of the information is regarding addresses and Size of sections and headers.</p>
<h1 id="segments-aka-program-headers">Segments (aka Program Headers)</h1>
<pre><code>readelf -h ``binary``
</code></pre>
<p><img src="/images/ELF_segments_sections_short_blog/3.png" alt="" /></p>
<p>This is a array of structures. Each describes the segments. The segments are used to tell, how to create a memory image when the binary is excecuted. When the Kernel sees these segments it will map them into the Virtual Memory with the help of mmap system call.</p>
<h2 id="phdr">PHDR</h2>
<p>Tells the location of the Program header itself if its present.</p>
<h2 id="interp">interp</h2>
<p>specifies the location and size of a null-terminated path name to invoke as an interpreter</p>
<ul>
<li><p>interpreter</p></li>
<li><p>* It is a program that excecutes certain specified instructions [not to worry now].</p></li>
</ul>
<h2 id="dynamic">dynamic</h2>
<p>This segment specifies the information needed for the dynamic linking process.</p>
<h2 id="gnu_eh_frame">GNU_EH_FRAME</h2>
<p>This stores exceptional handlers. When things go wrong this area can deal with it.</p>
<h2 id="gnu_stack">GNU_STACK</h2>
<ul>
<li>stack</li>
<li>* This is just a place where things can be stored during runtime. </li>
</ul>
<p>This GNU_STACK is responsible for the stack being excecutable. If this is not there then by default stack will be excecutable. If stack is enabled then user input can also be excecuted and can lead to a great havoc.</p>
<h2 id="elf-sections">ELF Sections</h2>
<p>This is also commonly called as section headers. This has the information needed for linking a target object file (dependencies) to the binary. This is needed on linktime but not on runtime.</p>
<h3 id="common-sections">Common Sections</h3>
<ul>
<li>.text: This section contains the code for the binary.</li>
<li>.data: Holds all the initialised data.</li>
<li>.rodata: Holds the initialised read-only data.</li>
<li>.bss: Contain all the uninitialized data.</li>
<li>.plt: PLT (Procedure Linkage Table) is useful when it comes to getting address of functions in dynamically linked libraries.</li>
<li>.got: Contains all the resolved address of the functions from the dependecies.</li>
<li>.dynamic: Holds all needed information for dynamic linking.</li>
<li>.dynsym: table dedicated to dynamically linked symbols.</li>
<li>.strtab: string table of .symtab section.</li>
<li>.dynstr: string table of .dynsym section.</li>
<li>.interp: RTLD embedded string.</li>
</ul>
<h2 id="end">END</h2>
<p>Hope you understood some basic concepts related to the ELF file format.</p>
<h2 id="sources">sources:</h2>
<ul>
<li><a href="https://www.intezer.com/blog/research/executable-linkable-format-101-part1-sections-segments/">intezer</a></li>
<li><a href="https://linux-audit.com/elf-binaries-on-linux-understanding-and-analysis/#program-headers">linux-audit</a></li>
</ul>
        </article>
        
        <!-- Navigation -->
        <nav class="mt-16 pt-8 border-t border-gray-700">
            <div class="flex justify-between items-center">
                <div class="flex-1">
                    <a href="/posts/expm1-35C3-Bug/-Optimizations-Analysis.html" class="inline-flex items-center text-emerald-400 hover:text-emerald-300 transition-colors">
                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                        <div class="text-left">
                            <div class="text-xs text-gray-400">Previous</div>
                            <div class="font-medium">expm1-35C3 - Bug/ Optimizations Analysis</div>
                        </div>
                    </a>
                </div>
                <div class="flex-1 text-center">
                    <a href="/blogs" class="text-emerald-400 hover:text-emerald-300 transition-colors font-medium">All Posts</a>
                </div>
                <div class="flex-1 text-right">
                    <a href="/posts/Dynamic-and-Static-Linking.html" class="inline-flex items-center text-emerald-400 hover:text-emerald-300 transition-colors">
                        <div class="text-right">
                            <div class="text-xs text-gray-400">Next</div>
                            <div class="font-medium">Dynamic and Static Linking</div>
                        </div>
                        <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                        </svg>
                    </a>
                </div>
            </div>
        </nav>
    </div>
<script>window.addEventListener('DOMContentLoaded',()=>{try{document.querySelectorAll('pre code').forEach((el)=>window.hljs&&window.hljs.highlightElement(el));}catch(e){console.warn('hljs init failed',e);}});</script>
</body>
</html>